!function(){function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function e(e,r){if(e){if("string"==typeof e)return t(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t(e,r)}}function r(r){return function(e){if(Array.isArray(e))return t(e)}(r)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||e(r)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var n=function(){var t;function n(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,n),this.initialState=t||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.state=this.initialState.map(function(t){return t.slice()}),this.status="idle"}return t=[{key:"moveLeft",value:function(){var t=this.state.map(function(t){return t.slice()}),e=!0,n=!1,a=void 0;try{for(var i,o=this,s=this.state[Symbol.iterator]();!(e=(i=s.next()).done);e=!0)!function(){for(var t=i.value,e=t.filter(function(t){return 0!==t}),n=0;n<e.length-1;n++)e[n]===e[n+1]&&(e[n]*=2,o.score+=e[n],e.splice(n+1,1));for(;e.length<o.state[0].length;)e.push(0);t.splice.apply(t,[0,o.state[0].length].concat(r(e)))}()}catch(t){n=!0,a=t}finally{try{e||null==s.return||s.return()}finally{if(n)throw a}}!function(t,e){for(var r=0;r<t.length;r++)for(var n=0;n<t[r].length;n++)if(t[r][n]!==e[r][n])return!1;return!0}(t,this.state)&&this.addRandomTile(),this.checkGameStatus()}},{key:"moveRight",value:function(){var t=!0,e=!1,r=void 0;try{for(var n,a=this.state[Symbol.iterator]();!(t=(n=a.next()).done);t=!0)n.value.reverse()}catch(t){e=!0,r=t}finally{try{t||null==a.return||a.return()}finally{if(e)throw r}}this.moveLeft();var i=!0,o=!1,s=void 0;try{for(var l,u=this.state[Symbol.iterator]();!(i=(l=u.next()).done);i=!0)l.value.reverse()}catch(t){o=!0,s=t}finally{try{i||null==u.return||u.return()}finally{if(o)throw s}}this.checkGameStatus()}},{key:"moveUp",value:function(){for(var t=[],e=0;e<this.state.length;e++)for(var n=0;n<this.state[e].length;n++)t[n]||(t[n]=[]),t[n][e]=this.state[e][n];var a=t.map(function(t){return t.slice()}),i=!0,o=!1,s=void 0;try{for(var l,u=this,c=t[Symbol.iterator]();!(i=(l=c.next()).done);i=!0)!function(){for(var t=l.value,e=t.filter(function(t){return 0!==t}),n=0;n<e.length-1;n++)e[n]===e[n+1]&&(e[n]*=2,u.score+=e[n],e.splice(n+1,1));for(;e.length<u.state[0].length;)e.push(0);t.splice.apply(t,[0,u.state[0].length].concat(r(e)))}()}catch(t){o=!0,s=t}finally{try{i||null==c.return||c.return()}finally{if(o)throw s}}for(var h=0;h<this.state.length;h++)for(var f=0;f<this.state[h].length;f++)this.state[h][f]=t[f][h];!function(t,e){for(var r=0;r<t.length;r++)for(var n=0;n<t[r].length;n++)if(t[r][n]!==e[r][n])return!1;return!0}(a,t)&&this.addRandomTile(),this.checkGameStatus()}},{key:"moveDown",value:function(){for(var t=0;t<this.state[0].length;t++){for(var e=[],r=0;r<this.state.length;r++)e.push(this.state[r][t]);e.reverse();for(var n=0;n<this.state.length;n++)this.state[n][t]=e[n]}this.moveUp();for(var a=0;a<this.state[0].length;a++){for(var i=[],o=0;o<this.state.length;o++)i.push(this.state[o][a]);i.reverse();for(var s=0;s<this.state.length;s++)this.state[s][a]=i[s]}this.checkGameStatus()}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.state}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){this.status="playing",this.state=this.initialState.map(function(t){return t.slice()}),this.addRandomTile(),this.addRandomTile()}},{key:"restart",value:function(){this.status="playing",this.score=0,this.state=this.initialState.map(function(t){return t.slice()}),this.addRandomTile(),this.addRandomTile()}},{key:"addRandomTile",value:function(){for(var t=[],r=0;r<this.state.length;r++)for(var n=0;n<this.state[r].length;n++)0===this.state[r][n]&&t.push([r,n]);if(0!==t.length){t.sort(function(){return Math.random()-.5});var a,i=function(t){if(Array.isArray(t))return t}(a=t[0])||function(t,e){var r,n,a=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=a){var i=[],o=!0,s=!1;try{for(a=a.call(t);!(o=(r=a.next()).done)&&(i.push(r.value),2!==i.length);o=!0);}catch(t){s=!0,n=t}finally{try{o||null==a.return||a.return()}finally{if(s)throw n}}return i}}(a,2)||e(a,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),o=i[0],s=i[1];this.state[o][s]=.9>Math.random()?2:4}}},{key:"checkGameStatus",value:function(){if(this.state.some(function(t){return t.includes(2048)})){this.status="win";return}if(!this.state.some(function(t){return t.includes(0)})){for(var t=0;t<4;t++)for(var e=0;e<4;e++){var r,n=this.state[t][e],a=this.state[t][e+1],i=null===(r=this.state[t+1])||void 0===r?void 0:r[e];if(n===a||n===i)return}this.status="lose"}}}],function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(n.prototype,t),n}(),a=document.querySelector(".button.start"),i=document.querySelector(".game-score"),o=document.querySelectorAll(".field-cell"),s=document.querySelectorAll(".btn-move"),l=new n;function u(){var t=l.getStatus();document.querySelector(".message-win").classList.toggle("hidden","win"!==t),document.querySelector(".message-lose").classList.toggle("hidden","lose"!==t)}function c(){i.textContent=l.getScore();var t=l.getState();o.forEach(function(e,r){var n=t[Math.floor(r/4)][r%4];e.textContent=0===n?"":n,e.className="field-cell",n&&e.classList.add("field-cell--".concat(n))}),a.textContent="Restart",document.querySelector(".message-start").classList.add("hidden"),document.querySelector(".message-win").classList.add("hidden"),document.querySelector(".message-lose").classList.add("hidden")}a.addEventListener("click",function(){a.classList.add("restart"),"idle"===l.getStatus()?l.start():l.restart(),c()}),document.addEventListener("keydown",function(t){if("playing"===l.getStatus()){var e={ArrowLeft:"moveLeft",ArrowRight:"moveRight",ArrowUp:"moveUp",ArrowDown:"moveDown"}[t.key];e&&(l[e](),c(),u())}}),s.forEach(function(t){t.addEventListener("click",function(){if("playing"===l.getStatus()){var e=t.dataset.move;e&&(l[e](),c(),u())}})})}();
//# sourceMappingURL=index.12172a0c.js.map
