var t=class{constructor(t){this.initialState=t||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.state=this.initialState.map(t=>t.slice()),this.status="idle"}moveLeft(){let t=this.state.map(t=>t.slice());for(let t of this.state){let e=t.filter(t=>0!==t);for(let t=0;t<e.length-1;t++)e[t]===e[t+1]&&(e[t]*=2,this.score+=e[t],e.splice(t+1,1));for(;e.length<this.state[0].length;)e.push(0);t.splice(0,this.state[0].length,...e)}!function(t,e){for(let s=0;s<t.length;s++)for(let i=0;i<t[s].length;i++)if(t[s][i]!==e[s][i])return!1;return!0}(t,this.state)&&this.addRandomTile(),this.checkGameStatus()}moveRight(){for(let t of this.state)t.reverse();for(let t of(this.moveLeft(),this.state))t.reverse();this.checkGameStatus()}moveUp(){let t=[];for(let e=0;e<this.state.length;e++)for(let s=0;s<this.state[e].length;s++)t[s]||(t[s]=[]),t[s][e]=this.state[e][s];let e=t.map(t=>t.slice());for(let e of t){let t=e.filter(t=>0!==t);for(let e=0;e<t.length-1;e++)t[e]===t[e+1]&&(t[e]*=2,this.score+=t[e],t.splice(e+1,1));for(;t.length<this.state[0].length;)t.push(0);e.splice(0,this.state[0].length,...t)}for(let e=0;e<this.state.length;e++)for(let s=0;s<this.state[e].length;s++)this.state[e][s]=t[s][e];!function(t,e){for(let s=0;s<t.length;s++)for(let i=0;i<t[s].length;i++)if(t[s][i]!==e[s][i])return!1;return!0}(e,t)&&this.addRandomTile(),this.checkGameStatus()}moveDown(){for(let t=0;t<this.state[0].length;t++){let e=[];for(let s=0;s<this.state.length;s++)e.push(this.state[s][t]);e.reverse();for(let s=0;s<this.state.length;s++)this.state[s][t]=e[s]}this.moveUp();for(let t=0;t<this.state[0].length;t++){let e=[];for(let s=0;s<this.state.length;s++)e.push(this.state[s][t]);e.reverse();for(let s=0;s<this.state.length;s++)this.state[s][t]=e[s]}this.checkGameStatus()}getScore(){return this.score}getState(){return this.state}getStatus(){return this.status}start(){this.status="playing",this.state=this.initialState.map(t=>t.slice()),this.addRandomTile(),this.addRandomTile()}restart(){this.status="playing",this.score=0,this.state=this.initialState.map(t=>t.slice()),this.addRandomTile(),this.addRandomTile()}addRandomTile(){let t=[];for(let e=0;e<this.state.length;e++)for(let s=0;s<this.state[e].length;s++)0===this.state[e][s]&&t.push([e,s]);if(0===t.length)return;t.sort(()=>Math.random()-.5);let[e,s]=t[0];this.state[e][s]=.9>Math.random()?2:4}checkGameStatus(){if(this.state.some(t=>t.includes(2048))){this.status="win";return}if(!this.state.some(t=>t.includes(0))){for(let t=0;t<4;t++)for(let e=0;e<4;e++){let s=this.state[t][e],i=this.state[t][e+1],a=this.state[t+1]?.[e];if(s===i||s===a)return}this.status="lose"}}};const e=document.querySelector(".button.start"),s=document.querySelector(".game-score"),i=document.querySelectorAll(".field-cell"),a=document.querySelectorAll(".btn-move"),l=new t;function r(){let t=l.getStatus();document.querySelector(".message-win").classList.toggle("hidden","win"!==t),document.querySelector(".message-lose").classList.toggle("hidden","lose"!==t)}function h(){s.textContent=l.getScore();let t=l.getState();i.forEach((e,s)=>{let i=t[Math.floor(s/4)][s%4];e.textContent=0===i?"":i,e.className="field-cell",i&&e.classList.add(`field-cell--${i}`)}),e.textContent="Restart",document.querySelector(".message-start").classList.add("hidden"),document.querySelector(".message-win").classList.add("hidden"),document.querySelector(".message-lose").classList.add("hidden")}e.addEventListener("click",()=>{e.classList.add("restart"),"idle"===l.getStatus()?l.start():l.restart(),h()}),document.addEventListener("keydown",t=>{if("playing"!==l.getStatus())return;let e={ArrowLeft:"moveLeft",ArrowRight:"moveRight",ArrowUp:"moveUp",ArrowDown:"moveDown"}[t.key];e&&(l[e](),h(),r())}),a.forEach(t=>{t.addEventListener("click",()=>{if("playing"!==l.getStatus())return;let e=t.dataset.move;e&&(l[e](),h(),r())})});
//# sourceMappingURL=index.1206d459.js.map
